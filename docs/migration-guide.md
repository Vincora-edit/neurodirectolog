# ğŸš€ ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° Ğ½Ğ¾Ğ²ÑƒÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ñ ÑĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€Ğ¾Ğ¼ Ñ†ĞµĞ»ĞµĞ¹

## âœ… Ğ§Ñ‚Ğ¾ Ğ±Ñ‹Ğ»Ğ¾ ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾

Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ° **Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…** Ğ´Ğ»Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ Ğ¯Ğ½Ğ´ĞµĞºÑ.Ğ”Ğ¸Ñ€ĞµĞºÑ‚, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ñ€ĞµÑˆĞ°ĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñƒ Ñ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¼Ğ¸ ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞ°Ğ¼Ğ¸ Ğ´Ğ»Ñ Ñ†ĞµĞ»ĞµĞ¹ ĞºĞ¾Ğ½Ğ²ĞµÑ€ÑĞ¸Ğ¹.

### Ğ¡Ñ‚Ğ°Ñ€Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°
```sql
-- ĞšĞ°Ğ¶Ğ´Ğ°Ñ Ñ†ĞµĞ»ÑŒ = Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ°Ñ ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞ° âŒ
Conversions_356549152_AUTO DECIMAL
Conversions_350326383_AUTO DECIMAL
Revenue_356549152_AUTO DECIMAL
-- ĞĞµĞ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ ÑĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€ Ñ†ĞµĞ»ĞµĞ¹!
```

### ĞĞ¾Ğ²Ğ¾Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ
```sql
-- ĞšĞ°Ğ¶Ğ´Ğ°Ñ ĞºĞ¾Ğ½Ğ²ĞµÑ€ÑĞ¸Ñ = Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ñ€Ğ¾ĞºĞ° âœ…
goal_id | conversions | revenue
--------|-------------|--------
356549152 | 5 | 50000
350326383 | 3 | 30000
-- Ğ›ĞµĞ³ĞºĞ¾ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ goal_id!
```

---

## ğŸ“Š ĞĞ¾Ğ²Ñ‹Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹

### 1. `campaign_performance`
ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ Ñ Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹ Ğ¿Ğ¾ Ğ¸Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸ÑĞ¼:
- Device (Ğ¼Ğ¾Ğ±Ğ°Ğ¹Ğ»/Ğ´ĞµÑĞºÑ‚Ğ¾Ğ¿)
- Age (Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚)
- Gender (Ğ¿Ğ¾Ğ»)
- IncomeGrade (Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ½Ğ¾ÑÑ‚ÑŒ)
- Placement (Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ĞºĞ¸)
- TargetingCategory, Criterion, MatchType Ğ¸ Ñ‚.Ğ´.

### 2. `campaign_conversions`
ĞšĞ¾Ğ½Ğ²ĞµÑ€ÑĞ¸Ğ¸ Ğ² Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¼ Ğ²Ğ¸Ğ´Ğµ:
- `goal_id` - ID Ñ†ĞµĞ»Ğ¸ (Ğ¿Ğ¾Ğ»Ğµ, Ğ½Ğµ ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞ°!)
- `conversions` - ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ¾Ğ½Ğ²ĞµÑ€ÑĞ¸Ğ¹
- `revenue` - Ğ´Ğ¾Ñ…Ğ¾Ğ´
- Ğ›ĞµĞ³ĞºĞ¾ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‡ĞµÑ€ĞµĞ· `WHERE goal_id = '356549152'`

### 3. `search_queries`
Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ Ğ¿Ğ¾Ğ¸ÑĞºĞ¾Ğ²Ñ‹Ğ¼ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°Ğ¼

### 4. `ad_contents`
Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğ¹ (Ñ‚ĞµĞºÑÑ‚Ñ‹, Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸, ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½ĞºĞ¸)

---

## ğŸ¯ ĞšĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ ÑĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€ Ñ†ĞµĞ»ĞµĞ¹

### Backend API

**ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞ¿Ğ¸ÑĞ¾Ğº Ñ†ĞµĞ»ĞµĞ¹:**
```bash
GET /api/yandex/available-goals/:projectId
```

ĞÑ‚Ğ²ĞµÑ‚:
```json
[
  { "goalId": "356549152", "goalName": "Ğ—Ğ°ÑĞ²ĞºĞ°" },
  { "goalId": "350326383", "goalName": "ĞšĞ²Ğ°Ğ»Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ" }
]
```

**ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ¼:**
```bash
GET /api/yandex/detailed-stats/:projectId?days=30&goalId=356549152
```

Ğ•ÑĞ»Ğ¸ `goalId` Ğ½Ğµ ÑƒĞºĞ°Ğ·Ğ°Ğ½ - ÑÑƒĞ¼Ğ¼Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ²ÑĞµ Ñ†ĞµĞ»Ğ¸.

### Frontend

Ğ”Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸:
1. Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ ÑĞ¿Ğ¸ÑĞ¾Ğº Ñ†ĞµĞ»ĞµĞ¹
2. ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ ÑĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€ "Ğ’ÑĞµ Ñ†ĞµĞ»Ğ¸ / Ğ¦ĞµĞ»ÑŒ 1 / Ğ¦ĞµĞ»ÑŒ 2"
3. ĞŸÑ€Ğ¸ ÑĞ¼ĞµĞ½Ğµ Ñ†ĞµĞ»Ğ¸ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ĞµÑ‚ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ¼
4. ĞŸĞµÑ€ĞµÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ²ÑĞµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ (CR, CPA, ROI) Ğ´Ğ»Ñ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ñ†ĞµĞ»Ğ¸

---

## ğŸ”„ Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ Ğ¿Ğ¾ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

### Ğ¨Ğ°Ğ³ 1: ĞŸĞµÑ€ĞµÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ

Ğ¡Ñ‚Ğ°Ñ€Ñ‹Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ **Ğ½Ğµ Ğ¸Ğ¼ĞµÑÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ² Ğ½Ğ¾Ğ²Ñ‹Ñ… Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ°Ñ…**. ĞÑƒĞ¶Ğ½Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ğ¾Ğµ:

1. ĞÑ‚ĞºÑ€Ğ¾Ğ¹ http://localhost:5173/connect-yandex-simple
2. Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸ Ñ„Ğ¾Ñ€Ğ¼Ñƒ:
   - **ĞŸÑ€Ğ¾ĞµĞºÑ‚**: Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹
   - **Ğ¢Ğ¾ĞºĞµĞ½**: Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ¾ ÑÑÑ‹Ğ»ĞºĞµ Ğ² Ñ„Ğ¾Ñ€Ğ¼Ğµ
   - **Ğ›Ğ¾Ğ³Ğ¸Ğ½**: Ñ‚Ğ²Ğ¾Ğ¹ Ğ»Ğ¾Ğ³Ğ¸Ğ½ Ğ¸Ğ»Ğ¸ Ğ»Ğ¾Ğ³Ğ¸Ğ½ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°
   - **ID Ñ†ĞµĞ»ĞµĞ¹**: **ĞĞ‘Ğ¯Ğ—ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ ÑƒĞºĞ°Ğ¶Ğ¸ ID Ñ†ĞµĞ»ĞµĞ¹** (Ñ‡ĞµÑ€ĞµĞ· Ğ·Ğ°Ğ¿ÑÑ‚ÑƒÑ)
     ```
     252254424, 293622736, 293622699
     ```
3. ĞĞ°Ğ¶Ğ¼Ğ¸ "ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ"

### Ğ¨Ğ°Ğ³ 2: Ğ”Ğ¾Ğ¶Ğ´Ğ°Ñ‚ÑŒÑÑ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

ĞŸĞµÑ€Ğ²Ğ°Ñ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¸ Ğ·Ğ°Ğ¹Ğ¼ĞµÑ‚ 1-2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹:
- Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ 92 ĞºĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸
- ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ñ‚Ñ‡ĞµÑ‚ Ğ·Ğ° 30 Ğ´Ğ½ĞµĞ¹
- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² Ğ½Ğ¾Ğ²Ñ‹Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹

### Ğ¨Ğ°Ğ³ 3: Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€ Ñ†ĞµĞ»ĞµĞ¹

ĞÑ‚ĞºÑ€Ğ¾Ğ¹ http://localhost:5173/yandex-dashboard

Ğ’ Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğ¼ Ğ²ĞµÑ€Ñ…Ğ½ĞµĞ¼ ÑƒĞ³Ğ»Ñƒ Ğ¿Ğ¾ÑĞ²Ğ¸Ñ‚ÑÑ ÑĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€:
```
[Ğ’ÑĞµ Ñ†ĞµĞ»Ğ¸ â–¼] [30 Ğ´Ğ½ĞµĞ¹ â–¼] [ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ]
```

ĞŸÑ€Ğ¸ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğµ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ¹ Ñ†ĞµĞ»Ğ¸:
- âœ… Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° ĞºĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¹ Ğ¿ĞµÑ€ĞµÑÑ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸
- âœ… ĞšĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº Ğ¾Ğ±Ğ½Ğ¾Ğ²ÑÑ‚ÑÑ
- âœ… ROI, CR, CPA Ğ±ÑƒĞ´ÑƒÑ‚ Ğ´Ğ»Ñ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ñ†ĞµĞ»Ğ¸

---

## ğŸ› ï¸ Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸

### ĞœĞµÑ‚Ğ¾Ğ´ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

```typescript
// server/src/services/sync.service.ts (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 108-115)
const performanceData = await yandexDirectService.getCampaignPerformanceReport(
  accessToken,
  connection.login,
  campaignIds,
  goalIds,  // Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ·Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ»Ñ Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ Ñ†ĞµĞ»Ğ¸!
  dateFrom,
  dateTo
);
```

### Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ğ²ĞµÑ€ÑĞ¸Ğ¹

```typescript
// Ğ¡Ñ‚Ñ€Ğ¾ĞºĞ¸ 175-196
goalIds.forEach((goalId: string) => {
  const conversionsField = `Conversions_${goalId}_AUTO`;
  const revenueField = `Revenue_${goalId}_AUTO`;

  const conversions = parseInt(row[conversionsField]) || 0;
  const revenue = parseFloat(row[revenueField]) || 0;

  if (conversions > 0 || revenue > 0) {
    conversionRecords.push({
      connectionId: connection.id,
      campaignId,
      date,
      goalId: String(goalId),  // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ ĞºĞ°Ğº ÑÑ‚Ñ€Ğ¾ĞºÑƒ!
      attributionModel: 'AUTO',
      conversions,
      revenue,
    });
  }
});
```

### SQL Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ¼

```typescript
// server/src/services/clickhouse.service.ts (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 563-586)
const conversionQuery = goalId
  ? `SELECT
      campaign_id,
      sum(conversions) as total_conversions,
      sum(revenue) as total_revenue
    FROM campaign_conversions
    WHERE connection_id = {connectionId:String}
      AND date >= {startDate:Date}
      AND date <= {endDate:Date}
      AND goal_id = {goalId:String}  -- Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ñ†ĞµĞ»Ğ¸!
    GROUP BY campaign_id`
  : `SELECT ... FROM campaign_conversions WHERE ...`;  -- Ğ’ÑĞµ Ñ†ĞµĞ»Ğ¸
```

---

## ğŸ“‹ ĞĞ±Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ

Ğ¡Ñ‚Ğ°Ñ€Ğ°Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° `campaign_stats` **Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°ĞµÑ‚ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ÑÑ‚ÑŒÑÑ** Ñ ÑÑƒĞ¼Ğ¼Ğ°Ñ€Ğ½Ñ‹Ğ¼Ğ¸ ĞºĞ¾Ğ½Ğ²ĞµÑ€ÑĞ¸ÑĞ¼Ğ¸ Ğ¿Ğ¾ Ğ²ÑĞµĞ¼ Ñ†ĞµĞ»ÑĞ¼:

```typescript
// Ğ¡Ñ‚Ñ€Ğ¾ĞºĞ° 246
await clickhouseService.insertCampaignStats(statsToInsert);
```

Ğ­Ñ‚Ğ¾ Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑĞµÑ‚:
- Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑ‚Ğ°Ñ€Ñ‹Ğ¹ endpoint `/api/yandex/stats/:projectId` (Ğ±ĞµĞ· ÑĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€Ğ°)
- ĞŸĞ¾ÑÑ‚ĞµĞ¿ĞµĞ½Ğ½Ğ¾ Ğ¼Ğ¸Ğ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ñ‹
- ĞĞµ Ğ»Ğ¾Ğ¼Ğ°Ñ‚ÑŒ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ÑƒÑ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ

---

## ğŸ‰ ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°

### 1. Ğ“Ğ¸Ğ±ĞºĞ¸Ğ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ñ†ĞµĞ»ĞµĞ¹
- Ğ¡ĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€ "Ğ’ÑĞµ Ñ†ĞµĞ»Ğ¸" - ÑÑƒĞ¼Ğ¼Ğ¸Ñ€ÑƒĞµÑ‚ Ğ²ÑĞµ ĞºĞ¾Ğ½Ğ²ĞµÑ€ÑĞ¸Ğ¸
- Ğ¡ĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ¹ Ñ†ĞµĞ»Ğ¸ - Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ÑƒĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑ‘

### 2. ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ
- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ¹ Ñ†ĞµĞ»Ğ¸ = Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ½Ğ¾Ğ²Ñ‹Ğµ ÑÑ‚Ñ€Ğ¾ĞºĞ¸ Ğ² Ğ‘Ğ”
- ĞĞµ Ğ½ÑƒĞ¶Ğ½Ğ¾ ALTER TABLE Ğ´Ğ»Ñ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ»Ğ¾Ğ½Ğ¾Ğº

### 3. ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
- ClickHouse ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾ `goal_id`
- ĞŸĞ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ´Ğ°Ñ‚Ğµ (PARTITION BY toYYYYMM(date))
- Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹ Ğ¿Ğ¾ (connection_id, campaign_id, goal_id, date)

### 4. ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ñ‚Ğ° Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸
```sql
-- Ğ¢Ğ¾Ğ¿-3 Ñ†ĞµĞ»Ğ¸ Ğ¿Ğ¾ ĞºĞ¾Ğ½Ğ²ĞµÑ€ÑĞ¸ÑĞ¼
SELECT goal_id, sum(conversions) as total
FROM campaign_conversions
WHERE connection_id = '...'
GROUP BY goal_id
ORDER BY total DESC
LIMIT 3;

-- Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸ĞºĞ° ĞºĞ¾Ğ½Ğ²ĞµÑ€ÑĞ¸Ğ¹ Ğ¿Ğ¾ Ğ´Ğ½ÑĞ¼ Ğ´Ğ»Ñ Ñ†ĞµĞ»Ğ¸
SELECT date, sum(conversions)
FROM campaign_conversions
WHERE goal_id = '356549152'
GROUP BY date
ORDER BY date;
```

---

## â“ FAQ

### Ğ’: Ğ§Ñ‚Ğ¾ Ğ±ÑƒĞ´ĞµÑ‚ ÑĞ¾ ÑÑ‚Ğ°Ñ€Ñ‹Ğ¼Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸?
**Ğ:** Ğ¡Ñ‚Ğ°Ñ€Ñ‹Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ğ¾ÑÑ‚Ğ°ÑÑ‚ÑÑ Ğ½ĞµÑ‚Ñ€Ğ¾Ğ½ÑƒÑ‚Ñ‹Ğ¼Ğ¸. ĞĞ¾Ğ²Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ´ÑƒÑ‚ Ğ² Ğ½Ğ¾Ğ²Ñ‹Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹.

### Ğ’: ĞÑƒĞ¶Ğ½Ğ¾ Ğ»Ğ¸ ÑƒĞ´Ğ°Ğ»ÑÑ‚ÑŒ ÑÑ‚Ğ°Ñ€Ğ¾Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ?
**Ğ:** ĞĞµ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾, Ğ½Ğ¾ **Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ¹Ğ´ÑƒÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ² Ğ½Ğ¾Ğ²Ñ‹Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹** Ğ¿Ğ¾ÑĞ»Ğµ Ğ¿ĞµÑ€ĞµÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ñ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ¸ĞµĞ¼ Ñ†ĞµĞ»ĞµĞ¹.

### Ğ’: ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ»Ğ¸ Ğ¼Ğ¸Ğ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ?
**Ğ:** Ğ”Ğ°, Ğ½Ğ¾ Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ Ğ½Ğ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ ÑĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸. Ğ¡ĞµĞ¹Ñ‡Ğ°Ñ Ğ¿Ñ€Ğ¾Ñ‰Ğµ Ğ¿ĞµÑ€ĞµÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞ²ĞµĞ¶Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ.

### Ğ’: Ğ¡ĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€ Ğ½Ğµ Ğ¿Ğ¾ÑĞ²Ğ»ÑĞµÑ‚ÑÑ Ğ² Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğµ
**Ğ:** Ğ£Ğ±ĞµĞ´Ğ¸ÑÑŒ Ñ‡Ñ‚Ğ¾:
1. ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¾ Ğ·Ğ°Ğ½Ğ¾Ğ²Ğ¾
2. Ğ£ĞºĞ°Ğ·Ğ°Ğ½Ñ‹ ID Ñ†ĞµĞ»ĞµĞ¹ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸
3. ĞŸÑ€Ğ¾ÑˆĞ»Ğ° Ğ¿ĞµÑ€Ğ²Ğ°Ñ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (1-2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹)
4. Ğ’ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğµ `campaign_conversions` ĞµÑÑ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ

### Ğ’: ĞšĞ°Ğº Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² ClickHouse?
```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ ĞºĞ¾Ğ½Ğ²ĞµÑ€ÑĞ¸Ğ¹
docker exec neurodirectolog-clickhouse clickhouse-client \
  --database=neurodirectolog \
  --query "SELECT count(), goal_id FROM campaign_conversions GROUP BY goal_id"

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ performance Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
docker exec neurodirectolog-clickhouse clickhouse-client \
  --database=neurodirectolog \
  --query "SELECT count() FROM campaign_performance"
```

---

## ğŸ”¥ Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ ÑˆĞ°Ğ³Ğ¸

1. **Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ğ¾Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ** Ñ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ¸ĞµĞ¼ Ñ†ĞµĞ»ĞµĞ¹
2. **ĞŸĞ¾Ğ´Ğ¾Ğ¶Ğ´Ğ°Ñ‚ÑŒ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ** (1-2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹)
3. **ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´** Ğ¸ ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ ÑĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€ Ñ†ĞµĞ»ĞµĞ¹
4. **ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±Ğ¾Ğ²Ğ°Ñ‚ÑŒ** Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°Ñ‚ÑŒ Ñ†ĞµĞ»Ğ¸ Ğ¸ ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ĞºĞ°Ğº Ğ¿ĞµÑ€ĞµÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ÑÑ‚ÑÑ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
5. **Ğ Ğ°Ğ´Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ** Ñ‡Ñ‚Ğ¾ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ğ½Ğµ Ğ½ÑƒĞ¶Ğ½Ñ‹ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞ¸! ğŸ‰

---

## ğŸ“ ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ°

Ğ•ÑĞ»Ğ¸ Ñ‡Ñ‚Ğ¾-Ñ‚Ğ¾ Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚:
1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ğ»Ğ¾Ğ³Ğ¸ ÑĞµÑ€Ğ²ĞµÑ€Ğ°: `cd server && npm run dev`
2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² ClickHouse (ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ²Ñ‹ÑˆĞµ)
3. Ğ£Ğ±ĞµĞ´Ğ¸ÑÑŒ Ñ‡Ñ‚Ğ¾ ÑƒĞºĞ°Ğ·Ğ°Ğ» ID Ñ†ĞµĞ»ĞµĞ¹ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸
4. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹ Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ€ÑƒÑ‡Ğ½ÑƒÑ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ĞºĞ½Ğ¾Ğ¿ĞºĞ¾Ğ¹ "ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ"
