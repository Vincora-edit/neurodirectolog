# โก ะัััััะน ััะฐัั: ะกะตะปะตะบัะพั ัะตะปะตะน ะบะพะฝะฒะตััะธะน

## ๐ฏ ะงัะพ ััะพ ะดะฐัั?

ะขะตะฟะตัั ะฝะฐ ะดะฐัะฑะพัะดะต ะผะพะถะฝะพ **ะฒัะฑัะฐัั ะบะพะฝะบัะตัะฝัั ัะตะปั ะบะพะฝะฒะตััะธะธ** ะธ ัะฒะธะดะตัั ะผะตััะธะบะธ ะธะผะตะฝะฝะพ ะฟะพ ะฝะตะน!

```
[ะัะต ัะตะปะธ โผ]  โ  [ะะฐัะฒะบะฐ โผ]  โ  [ะะฒะฐะปะธัะธะบะฐัะธั โผ]
```

ะขะฐะฑะปะธัะฐ ะบะฐะผะฟะฐะฝะธะน ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟะตัะตััะธัะฐะตััั ั ะบะพะฝะฒะตััะธัะผะธ ัะพะปัะบะพ ะดะปั ะฒัะฑัะฐะฝะฝะพะน ัะตะปะธ.

---

## ๐ 3 ัะฐะณะฐ ะดะพ ัะฐะฑะพัั

### 1. ะะตัะตัะพะทะดะฐะน ะฟะพะดะบะปััะตะฝะธะต
```
http://localhost:5173/connect-yandex-simple
```

**ะะะะะ:** ะ ะฟะพะปะต "ID ัะตะปะตะน" ัะบะฐะถะธ ัะตัะตะท ะทะฐะฟัััั:
```
252254424, 293622736, 293622699
```

ะะตะท ัะตะปะตะน ัะตะปะตะบัะพั ะฝะต ะฟะพัะฒะธััั!

### 2. ะะพะดะพะถะดะธ ัะธะฝััะพะฝะธะทะฐัะธั (1-2 ะผะธะฝััั)

ะะตัะฒะฐั ัะธะฝััะพะฝะธะทะฐัะธั ะทะฐะฟะพะปะฝะธั:
- โ campaign_performance (ะดะตัะฐะปัะฝะฐั ััะฐัะธััะธะบะฐ)
- โ campaign_conversions (ะบะพะฝะฒะตััะธะธ ะบะฐะบ ัััะพะบะธ, ะฝะต ะบะพะปะพะฝะบะธ!)

### 3. ะัะบัะพะน ะดะฐัะฑะพัะด
```
http://localhost:5173/yandex-dashboard
```

ะกะตะปะตะบัะพั ะฟะพัะฒะธััั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฒ ะฟัะฐะฒะพะผ ะฒะตััะฝะตะผ ัะณะปั!

---

## ๐จ ะะฐะบ ะฒัะณะปัะดะธั

**ะจะฐะฟะบะฐ ะดะฐัะฑะพัะดะฐ:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะฝะฐะปะธัะธะบะฐ ะฏะฝะดะตะบั.ะะธัะตะบั                [ะัะต ัะตะปะธ โผ]         โ
โ ะะพะดะบะปััะตะฝ: poisk-finon-381468-p8ln    [30 ะดะฝะตะน โผ]          โ
โ                                        [ะะฑะฝะพะฒะธัั]            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะัะธ ะฒัะฑะพัะต ะบะพะฝะบัะตัะฝะพะน ัะตะปะธ:**
- ะะฐััะพัะบะธ ะผะตััะธะบ (ะะฐััะพะด, ะะปะธะบะธ, **ะะพะฝะฒะตััะธะธ**, ROI) ะฟะตัะตััะธัะฐัััั
- ะขะฐะฑะปะธัะฐ ะบะฐะผะฟะฐะฝะธะน ะฟะพะบะฐะถะตั ะบะพะฝะฒะตััะธะธ ัะพะปัะบะพ ะดะปั ะฒัะฑัะฐะฝะฝะพะน ัะตะปะธ
- CR, CPA, ROI ะฑัะดัั ัะฐัััะธัะฐะฝั ะฟะพ ะฒัะฑัะฐะฝะฝะพะน ัะตะปะธ

---

## ๐ ะัะพะฒะตัะบะฐ ััะพ ะฒัั ัะฐะฑะพัะฐะตั

### 1. ะกะตะปะตะบัะพั ะฟะพัะฒะธะปัั?
```bash
# ะัะพะฒะตัั ััะพ ะฒ ะะ ะตััั ะบะพะฝะฒะตััะธะธ
docker exec neurodirectolog-clickhouse clickhouse-client \
  --database=neurodirectolog \
  --query "SELECT goal_id, count() FROM campaign_conversions GROUP BY goal_id"
```

ะะพะปะถะฝะพ ะฒัะฒะตััะธ:
```
356549152   1234
350326383   567
441969763   890
```

### 2. ะกะตะปะตะบัะพั ะฝะต ะฟะพัะฒะธะปัั?

**ะัะธัะธะฝะฐ:** ะะตั ะดะฐะฝะฝัั ะฒ `campaign_conversions`

**ะะตัะตะฝะธะต:**
1. ะฃะฑะตะดะธัั ััะพ ะฟัะธ ะฟะพะดะบะปััะตะฝะธะธ ัะบะฐะทะฐะป ID ัะตะปะตะน
2. ะะฐะฟัััะธ ัััะฝัั ัะธะฝััะพะฝะธะทะฐัะธั ะบะฝะพะฟะบะพะน "ะะฑะฝะพะฒะธัั"
3. ะัะพะฒะตัั ะปะพะณะธ: `cd server && npm run dev`

---

## ๐ก ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะะตะนั 1: ะะฝะฐะปะธะท ะฒะพัะพะฝะบะธ
```
1. ะัะฑะตัะธ "ะะฐัะฒะบะฐ" (ะฒะตััะฝัั ัะตะปั) โ ัะผะพััะธ CR, CPA
2. ะัะฑะตัะธ "ะะฒะฐะปะธัะธะบะฐัะธั" โ ัะผะพััะธ ัะบะพะปัะบะพ ะธะท ะทะฐัะฒะพะบ ะบะฒะฐะปะธัะธัะธัะพะฒะฐะปะพัั
3. ะัะฑะตัะธ "ะัััะตัะฐ" โ ัะผะพััะธ ัะบะพะปัะบะพ ะดะพัะปะพ ะดะพ ะฒัััะตัะธ
```

### ะะตะนั 2: ะะฟัะธะผะธะทะฐัะธั ะฟะพ ัะตะปัะผ
```
1. ะัะฑะตัะธ "ะัะต ัะตะปะธ" โ ะฝะฐะนะดะธ ะบะฐะผะฟะฐะฝะธะธ ั ROI < 0
2. ะัะฑะตัะธ "ะัะพะดะฐะถะฐ" (ะบะพะฝะตัะฝะฐั ัะตะปั) โ ะฟัะพะฒะตัั ะธั ROI ะฟะพ ะฟัะพะดะฐะถะฐะผ
3. ะัะปะธ ROI ะฟะพ ะฟัะพะดะฐะถะฐะผ > 0, ะฝะพ ะฟะพ ะพะฑัะธะผ ัะตะปัะผ < 0 โ
   โ ะฟัะพะผะตะถััะพัะฝัะต ัะตะปะธ "ะณััะทะฝัะต"
```

### ะะตะนั 3: ะะพะธัะบ ััะตัะตะบ
```
1. ะัะฑะตัะธ "ะะฐัะฒะบะฐ" โ ัะผะพััะธ ัะพะฟ ะบะฐะผะฟะฐะฝะธะน ะฟะพ ะบะพะปะธัะตััะฒั
2. ะัะฑะตัะธ "ะะฒะฐะปะธัะธะบะฐัะธั" โ ะฟัะพะฒะตัั ัะต ะถะต ะบะฐะผะฟะฐะฝะธะธ
3. ะัะปะธ ะบะพะฝะฒะตััะธั ะฒ ะบะฒะฐะป ะฝะธะทะบะฐั โ ะฟัะพะฑะปะตะผะฐ ั ะบะฐัะตััะฒะพะผ ะปะธะดะพะฒ
```

---

## ๐ ะงัะพ ะฟะตัะตััะธััะฒะฐะตััั ะฟัะธ ัะผะตะฝะต ัะตะปะธ

| ะะตััะธะบะฐ | ะคะพัะผัะปะฐ ั ัะตะปะตะบัะพัะพะผ |
|---------|---------------------|
| ะะพะฝะฒะตััะธะธ | `SUM(conversions) WHERE goal_id = selected` |
| CR | `(ะะพะฝะฒะตััะธะธ / ะะปะธะบะธ) * 100` |
| CPA | `ะะฐััะพะด / ะะพะฝะฒะตััะธะธ` |
| ะะพัะพะด | `SUM(revenue) WHERE goal_id = selected` |
| ROI | `((ะะพัะพะด - ะะฐััะพะด) / ะะฐััะพะด) * 100` |

ะะปะธะบะธ, ะฟะพะบะฐะทั, CTR, CPC ะพััะฐัััั ะฝะตะธะทะผะตะฝะฝัะผะธ (ะฝะต ะทะฐะฒะธััั ะพั ัะตะปะตะน).

---

## ๐ฅ ะงะตะผ ะปัััะต ััะฐัะพะน ัะธััะตะผั

### ะัะปะพ โ
```sql
-- ะคะธะบัะธัะพะฒะฐะฝะฝัะต ะบะพะปะพะฝะบะธ ะฒ ัะฐะฑะปะธัะต
Conversions_356549152_AUTO DECIMAL
Conversions_350326383_AUTO DECIMAL
Conversions_441969763_AUTO DECIMAL
```

**ะัะพะฑะปะตะผั:**
- ะะตะปัะทั ะดะธะฝะฐะผะธัะตัะบะธ ะฒัะฑัะฐัั ัะตะปั
- ะะพะฑะฐะฒะปะตะฝะธะต ัะตะปะธ = ALTER TABLE
- ะกะตะปะตะบัะพั ััะตะฑัะตั ะดะธะฝะฐะผะธัะตัะบะธะน SQL

### ะกัะฐะปะพ โ
```sql
-- ะะพัะผะฐะปะธะทะพะฒะฐะฝะฝะฐั ััััะบัััะฐ
goal_id | conversions
--------|------------
356549152 | 50
350326383 | 30
441969763 | 20
```

**ะัะตะธะผััะตััะฒะฐ:**
- ะัะพััะพะน `WHERE goal_id = '356549152'`
- ะะพะฑะฐะฒะปะตะฝะธะต ัะตะปะธ = ะฝะพะฒัะต ัััะพะบะธ
- ะกะตะปะตะบัะพั ัะฐะฑะพัะฐะตั ะธะท ะบะพัะพะฑะบะธ!

---

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝัะต ัะธัะธ

### API ะดะพัััะฟะตะฝ ะฝะฐะฟััะผัั
```bash
# ะัะต ัะตะปะธ
curl "http://localhost:3001/api/yandex/detailed-stats/proj_123?days=30"

# ะะพะฝะบัะตัะฝะฐั ัะตะปั
curl "http://localhost:3001/api/yandex/detailed-stats/proj_123?days=30&goalId=356549152"

# ะกะฟะธัะพะบ ัะตะปะตะน
curl "http://localhost:3001/api/yandex/available-goals/proj_123"
```

### ะะฑัะฐัะฝะฐั ัะพะฒะผะตััะธะผะพััั
ะกัะฐััะน endpoint `/api/yandex/stats/:projectId` ะฟัะพะดะพะปะถะฐะตั ัะฐะฑะพัะฐัั ั ััะผะผะฐัะฝัะผะธ ะบะพะฝะฒะตััะธัะผะธ.

---

## ๐ ะงะฐัััะต ะฒะพะฟัะพัั

**Q: ะกะตะปะตะบัะพั ะฟัััะพะน**
A: ะะฐะฟัััะธ ัะธะฝััะพะฝะธะทะฐัะธั, ะฟะพะดะพะถะดะธ 1-2 ะผะธะฝััั

**Q: ะะพะฝะฒะตััะธะธ ะฒะตะทะดะต 0**
A: ะัะพะฒะตัั ััะพ ัะบะฐะทะฐะป ID ัะตะปะตะน ะฟัะธ ะฟะพะดะบะปััะตะฝะธะธ

**Q: ะกะตะปะตะบัะพั ะตััั, ะฝะพ ะฒัะฑะพั ะฝะต ะผะตะฝัะตั ัะธััั**
A: ะะตัะตะทะฐะณััะทะธ ัััะฐะฝะธัั, ะฟัะพะฒะตัั ะบะพะฝัะพะปั ะฑัะฐัะทะตัะฐ (F12)

**Q: ะะพะถะฝะพ ะปะธ ะดะพะฑะฐะฒะธัั ะฝะพะฒัั ัะตะปั?**
A: ะะฐ! ะัะพััะพ ะฟะตัะตัะพะทะดะฐะน ะฟะพะดะบะปััะตะฝะธะต ั ะฝะพะฒัะผ ัะฟะธัะบะพะผ ัะตะปะตะน

**Q: ะัะดะฐ ะดะตะปะธัั ััะฐััะต ะดะฐะฝะฝัะต?**
A: ะะฝะธ ะฒ ััะฐัะพะน ัะฐะฑะปะธัะต `campaign_stats`. ะะพะฒัะต ะธะดัั ะฒ ะฝะพะฒัะต ัะฐะฑะปะธัั.

---

## โ ะงะตะบะปะธัั ะฟัะพะฒะตัะบะธ

- [ ] ะะตัะตัะพะทะดะฐะป ะฟะพะดะบะปััะตะฝะธะต ั ัะบะฐะทะฐะฝะธะตะผ ID ัะตะปะตะน
- [ ] ะะพะถะดะฐะปัั ะทะฐะฒะตััะตะฝะธั ัะธะฝััะพะฝะธะทะฐัะธะธ
- [ ] ะัะบััะป ะดะฐัะฑะพัะด ะธ ัะฒะธะดะตะป ัะตะปะตะบัะพั
- [ ] ะะตัะตะบะปััะธะป ั "ะัะต ัะตะปะธ" ะฝะฐ ะบะพะฝะบัะตัะฝัั ัะตะปั
- [ ] ะะตััะธะบะธ ะฒ ัะฐะฑะปะธัะต ะฟะตัะตััะธัะฐะปะธัั
- [ ] ะะฐััะพัะบะธ ะฒะฒะตััั (ะะพะฝะฒะตััะธะธ, ROI) ะพะฑะฝะพะฒะธะปะธัั

ะัะปะธ ะฒัะต ะฟัะฝะบัั โ - ะฒัั ัะฐะฑะพัะฐะตั! ๐

---

**ะะพัะพะฒ ะธัะฟะพะปัะทะพะฒะฐัั?** โ http://localhost:5173/yandex-dashboard
